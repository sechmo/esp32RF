#include <Arduino.h>
#include <RCSwitch.h>

RCSwitch mySwitch = RCSwitch();

const bool isReceiver = true;

// Pins working output
// 15, 2, 4, 16, 17, 5, 18, 19, 21, 3, 1, 22, 23, 33,
// 13, 12, 14, 27, 26, 25, 33, 32,

const int inputPin = GPIO_NUM_33;
const int outputPin = GPIO_NUM_19;
const int ledPin = GPIO_NUM_2;

void setup()
{
  // put your setup code here, to run once:
  Serial.begin(9600);
  if (isReceiver)
  {
    Serial.println("Receiver");
    pinMode(inputPin, INPUT);
    Serial.println("Starting program");
    Serial.println(digitalPinToInterrupt(inputPin));
    Serial.println(inputPin);

    mySwitch.enableReceive(digitalPinToInterrupt(inputPin));
  }
  else
  {
    Serial.println("Transmitter");
    pinMode(outputPin, OUTPUT);
    mySwitch.enableTransmit(outputPin);
  }

  mySwitch.setPulseLength(360);
  pinMode(ledPin, OUTPUT);
}


void loopReceiver()
{
  if (mySwitch.available())
  {
    Serial.println("Received");
    Serial.println(mySwitch.getReceivedValue());
    mySwitch.resetAvailable();
    delay(1000);
    digitalWrite(ledPin, HIGH);
    delay(1000);
    digitalWrite(ledPin, LOW);
  }
}


void loopTransmitter()
{
  mySwitch.send(0b10, 2);
  digitalWrite(ledPin, HIGH);
  delay(1000);
  mySwitch.send(0b11, 2);
  digitalWrite(ledPin, LOW);
  delay(1000);
}

void loop()
{
  if (isReceiver)
  {
    loopReceiver();
  }
  else
  {
    loopTransmitter();
  }

}
